import{a as I,r as i,A as E,t as x,j as e,B as L,C as n}from"./index-Pe1Nv6hH.js";import{u as O,a as R,F as q,b as a,c,d as m,e as l,g as f,f as u}from"./form-DU65aaqX.js";import{u as V}from"./useQuery-DDON36P9.js";import{u as M}from"./useMutation-uvHqRPk1.js";import{S as A}from"./index-BmISbovJ.js";import{I as T}from"./input-DW-mBlUw.js";import{R as h}from"./index-B79q5nRO.js";import{updateConfig as k,getConfig as B}from"./config-Bb2IP3LG.js";import{L as j}from"./loader-circle-DjNfctPA.js";import{I as y}from"./image-D4KB7jNL.js";import"./index-DGhUbGt9.js";import"./sidebar-BFSPGCEL.js";import"./createLucideIcon-BU8aI1FG.js";import"./index-D68Ta3NN.js";import"./index-SpxnGYUf.js";import"./index-C8jai3VV.js";import"./dialog-DHifiqsD.js";import"./scroll-area-BCr0FWtA.js";import"./resource-u0oZDgOZ.js";import"./upload-CE8x_1SM.js";import"./chevron-left-BrCT33MH.js";import"./chevron-right-COcvBQ44.js";const P=o=>E({title:n().min(1,o("features.system.config.form.validation.titleRequired")),logo:n().min(1,o("features.system.config.form.validation.logoRequired")),icon:n().min(1,o("features.system.config.form.validation.iconRequired"))});function K(){const{t:o}=I(),[b,d]=i.useState(!1),[v,g]=i.useState(!1),S=i.useMemo(()=>P(o),[o]),{data:r,isLoading:C}=V({queryKey:["systemConfig"],queryFn:B}),t=O({resolver:R(S),defaultValues:{title:"",logo:"",icon:""}});i.useEffect(()=>{r?.systemConfig&&t.reset({title:r.systemConfig.title||"",logo:r.systemConfig.logo||"",icon:r.systemConfig.icon||""})},[r,t]);const{mutate:F,isPending:p}=M({mutationFn:k,onSuccess:()=>{x.success(o("features.system.config.form.saveSuccess"))},onError:s=>{x.error(s instanceof Error?s.message:o("features.system.config.form.saveError"))}}),N=s=>{F(s)},w=s=>{t.setValue("logo",s.url,{shouldValidate:!0})},D=s=>{t.setValue("icon",s.url,{shouldValidate:!0})};return C?e.jsx("div",{className:"flex h-[400px] items-center justify-center",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between px-4 pt-4",children:e.jsx(A,{title:o("features.system.config.title"),description:o("features.system.config.description")})}),e.jsx("div",{className:"rounded-md border p-6 mx-4",children:e.jsx(q,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(N),className:"space-y-6",children:[e.jsx(a,{control:t.control,name:"title",render:({field:s})=>e.jsxs(c,{children:[e.jsx(m,{children:o("features.system.config.form.title")}),e.jsx(l,{children:e.jsx(T,{placeholder:o("features.system.config.form.titlePlaceholder"),...s})}),e.jsx(f,{children:o("features.system.config.form.titleDescription")}),e.jsx(u,{})]})}),e.jsx(a,{control:t.control,name:"logo",render:({field:s})=>e.jsxs(c,{children:[e.jsx(m,{children:o("features.system.config.form.logo")}),e.jsx(l,{children:e.jsx("button",{type:"button",onClick:()=>d(!0),className:"flex h-20 w-40 items-center justify-center overflow-hidden rounded-lg border-2 border-dashed border-muted-foreground/30 bg-muted/50 transition-colors hover:border-primary/50 hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:s.value?e.jsx("img",{src:s.value,alt:o("features.system.config.form.logoAlt"),className:"h-full w-full object-contain"}):e.jsx(y,{className:"h-8 w-8 text-muted-foreground"})})}),e.jsx(f,{children:o("features.system.config.form.logoDescription")}),e.jsx(u,{})]})}),e.jsx(a,{control:t.control,name:"icon",render:({field:s})=>e.jsxs(c,{children:[e.jsx(m,{children:o("features.system.config.form.icon")}),e.jsx(l,{children:e.jsx("button",{type:"button",onClick:()=>g(!0),className:"flex h-16 w-16 items-center justify-center overflow-hidden rounded-lg border-2 border-dashed border-muted-foreground/30 bg-muted/50 transition-colors hover:border-primary/50 hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:s.value?e.jsx("img",{src:s.value,alt:o("features.system.config.form.iconAlt"),className:"h-full w-full object-contain"}):e.jsx(y,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsx(f,{children:o("features.system.config.form.iconDescription")}),e.jsx(u,{})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(L,{type:"submit",disabled:p,children:[p&&e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),o("features.system.config.form.save")]})})]})})}),e.jsx(h,{open:b,onOpenChange:d,onSelect:w,type:1,title:o("features.system.config.dialog.logoTitle"),description:o("features.system.config.dialog.logoDescription")}),e.jsx(h,{open:v,onOpenChange:g,onSelect:D,type:1,title:o("features.system.config.dialog.iconTitle"),description:o("features.system.config.dialog.iconDescription")})]})}const le=K;export{le as component};
