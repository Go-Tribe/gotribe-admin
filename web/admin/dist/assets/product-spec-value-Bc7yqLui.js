import{a as Y,r as i,A as te,j as e,B as S,P as se,Q as re,C as z,S as A,l as ae,t as h}from"./index-Pe1Nv6hH.js";import{u as Z}from"./useQuery-DDON36P9.js";import{u as _}from"./useMutation-uvHqRPk1.js";import{P as oe,T as ce,u as le,g as ne,c as ie,b as ue}from"./react-icons.esm-CiMB90YA.js";import{S as de}from"./index-BmISbovJ.js";import{D as x,T as me,a as pe,b as g,c as fe,d as he,e as I}from"./column-header-Cfszq_dp.js";import{B as xe}from"./badge-T19Q3klL.js";import{T as H,v as O,w as Q}from"./sidebar-BFSPGCEL.js";import{C as ge}from"./confirm-dialog-DmDS_GmK.js";import{g as Se}from"./status-variants-Dh7YK7JP.js";import{u as je,a as be,F as Ve,b as y,c as C,d as N,e as v,f as T}from"./form-DU65aaqX.js";import{D as De,a as Ie,b as ye,c as Ce,d as Ne,e as ve}from"./dialog-DHifiqsD.js";import{I as G}from"./input-DW-mBlUw.js";import{S as J,a as U,b as W,c as X,d as K}from"./select-Dl4KSF7A.js";import{g as Te}from"./product-spec-BGfX0G0n.js";import{c as we,u as Ee,d as Fe,g as Pe}from"./product-spec-item-XYjFlwSv.js";import"./dropdown-menu-CbU9G1H2.js";import"./index-SpxnGYUf.js";import"./createLucideIcon-BU8aI1FG.js";import"./index-4GH7Kv3S.js";import"./index-C8jai3VV.js";import"./index-D68Ta3NN.js";import"./index-BDzuQ5ZL.js";import"./chevron-right-COcvBQ44.js";import"./index-DGhUbGt9.js";const Me=s=>te({specID:z().min(1,s("features.store.productSpecValue.form.validation.specIDRequired")),title:z().min(1,s("features.store.productSpecValue.form.validation.titleRequired")),sort:re().int().min(0),enabled:se([A(0),A(1)])});function Re({open:s,onOpenChange:u,onSubmit:j,onSubmitUpdate:f,isLoading:d=!1,editItem:c}){const{t:a}=Y(),m=!!c,w=i.useMemo(()=>Me(a),[a]),{data:E}=Z({queryKey:["productSpecList",{pageNum:1,pageSize:200}],queryFn:()=>Te({pageNum:1,pageSize:200}),enabled:s}),b=E?.productSpecs??[],l=je({resolver:be(w),defaultValues:{specID:"",title:"",sort:1,enabled:1}});i.useEffect(()=>{s&&(c?l.reset({specID:(c.specID??"").trim(),title:(c.title??"").trim(),sort:c.sort??1,enabled:c.enabled===0?0:1}):l.reset({specID:"",title:"",sort:1,enabled:1}))},[s,c,l]);function F(o){m&&c&&f?f((c.productSpecItemID??"").trim(),{specID:o.specID.trim(),title:o.title.trim(),sort:o.sort,enabled:o.enabled}):j&&j({specID:o.specID.trim(),title:o.title.trim(),sort:o.sort,enabled:o.enabled})}return e.jsx(De,{open:s,onOpenChange:u,children:e.jsxs(Ie,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[e.jsxs(ye,{className:"shrink-0",children:[e.jsx(Ce,{children:a(m?"features.store.productSpecValue.form.editTitle":"features.store.productSpecValue.form.dialogTitle")}),e.jsx(Ne,{children:a(m?"features.store.productSpecValue.form.editDescription":"features.store.productSpecValue.form.createDescription")})]}),e.jsx(Ve,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(F),className:"flex-1 overflow-y-auto pr-2 space-y-4 min-h-0",children:[e.jsx(y,{control:l.control,name:"specID",render:({field:o})=>e.jsxs(C,{className:"grid grid-cols-[140px_1fr] items-center gap-4 space-y-0",children:[e.jsx(N,{className:"text-right",children:a("features.store.productSpecValue.form.specID")}),e.jsxs(J,{value:o.value,onValueChange:o.onChange,disabled:b.length===0,children:[e.jsx(v,{children:e.jsx(U,{children:e.jsx(W,{placeholder:a("features.store.productSpecValue.form.specIDPlaceholder")})})}),e.jsx(X,{children:b.map(n=>{const p=(n.productSpecID??"").trim(),V=(n.title??"").trim()||p||"-";return e.jsx(K,{value:p,children:V},p)})})]}),e.jsx(T,{className:"col-start-2"})]})}),e.jsx(y,{control:l.control,name:"title",render:({field:o})=>e.jsxs(C,{className:"grid grid-cols-[140px_1fr] items-center gap-4 space-y-0",children:[e.jsx(N,{className:"text-right",children:a("features.store.productSpecValue.form.title")}),e.jsx(v,{children:e.jsx(G,{placeholder:a("features.store.productSpecValue.form.titlePlaceholder"),...o})}),e.jsx(T,{className:"col-start-2"})]})}),e.jsx(y,{control:l.control,name:"sort",render:({field:o})=>e.jsxs(C,{className:"grid grid-cols-[140px_1fr] items-center gap-4 space-y-0",children:[e.jsx(N,{className:"text-right",children:a("features.store.productSpecValue.form.sort")}),e.jsx(v,{children:e.jsx(G,{type:"number",min:0,...o,onChange:n=>o.onChange(n.target.value===""?0:Number(n.target.value))})}),e.jsx(T,{className:"col-start-2"})]})}),e.jsx(y,{control:l.control,name:"enabled",render:({field:o})=>e.jsxs(C,{className:"grid grid-cols-[140px_1fr] items-center gap-4 space-y-0",children:[e.jsx(N,{className:"text-right",children:a("features.store.productSpecValue.form.enabled")}),e.jsxs(J,{value:String(o.value),onValueChange:n=>o.onChange(Number(n)),children:[e.jsx(v,{children:e.jsx(U,{children:e.jsx(W,{placeholder:a("features.store.productSpecValue.form.enabledPlaceholder")})})}),e.jsxs(X,{children:[e.jsx(K,{value:"1",children:a("features.store.productSpecValue.statusEnum.enable")}),e.jsx(K,{value:"0",children:a("features.store.productSpecValue.statusEnum.disable")})]})]}),e.jsx(T,{className:"col-start-2"})]})}),e.jsxs(ve,{className:"shrink-0",children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>u(!1),disabled:d,children:a("features.store.productSpecValue.form.cancel")}),e.jsx(S,{type:"submit",disabled:d,children:d?"...":a("features.store.productSpecValue.form.submit")})]})]})})]})})}function _e(s){return{id:(s.productSpecItemID??"").trim(),title:(s.title??"").trim()||"-",specID:(s.specID??"").trim()||"-",sort:s.sort??0,enabled:s.enabled??0,createdAt:(s.createdAt??"").trim()||"-"}}function Ke(){"use no memo";const{t:s}=Y(),u=ae(),[j,f]=i.useState(!1),[d,c]=i.useState(null),[a,m]=i.useState(null),[w,E]=i.useState([]),[b,l]=i.useState({}),{data:F,isLoading:o,error:n}=Z({queryKey:["productSpecItemList"],queryFn:Pe}),p=F?.productSpecItems??[],V=i.useMemo(()=>p.map(t=>_e(t)),[p]),L=d!=null?p.find(t=>(t.productSpecItemID??"").trim()===d)??null:null,k=_({mutationFn:t=>we(t),onSuccess:()=>{h.success(s("features.store.productSpecValue.createSuccess")),u.invalidateQueries({queryKey:["productSpecItemList"]}),f(!1)},onError:t=>{h.error(t instanceof Error?t.message:s("features.store.productSpecValue.createError"))}}),q=_({mutationFn:({productSpecItemID:t,data:r})=>Ee(t,r),onSuccess:()=>{h.success(s("features.store.productSpecValue.updateSuccess")),u.invalidateQueries({queryKey:["productSpecItemList"]}),c(null)},onError:t=>{h.error(t instanceof Error?t.message:s("features.store.productSpecValue.updateError"))}}),B=_({mutationFn:t=>Fe({productSpecItemIds:t}),onSuccess:()=>{h.success(s("features.store.productSpecValue.deleteSuccess")),u.invalidateQueries({queryKey:["productSpecItemList"]}),m(null)},onError:t=>{h.error(t instanceof Error?t.message:s("features.store.productSpecValue.deleteError"))}}),$=()=>{a&&B.mutate(a)},ee=V.find(t=>t.id===a),D=i.useMemo(()=>[{accessorKey:"id",header:({column:t})=>e.jsx(x,{column:t,title:s("features.store.productSpecValue.scenario.columns.id")}),cell:({row:t})=>e.jsx("div",{className:"font-mono text-muted-foreground",children:t.getValue("id")?.trim()??"-"})},{accessorKey:"title",header:({column:t})=>e.jsx(x,{column:t,title:s("features.store.productSpecValue.scenario.columns.title")}),cell:({row:t})=>e.jsx("div",{className:"max-w-[160px] truncate font-medium",title:t.getValue("title"),children:t.getValue("title")??"-"})},{accessorKey:"specID",header:({column:t})=>e.jsx(x,{column:t,title:s("features.store.productSpecValue.scenario.columns.specID")}),cell:({row:t})=>e.jsx("div",{className:"font-mono text-muted-foreground",children:t.getValue("specID")??"-"})},{accessorKey:"sort",header:({column:t})=>e.jsx(x,{column:t,title:s("features.store.productSpecValue.scenario.columns.sort")}),cell:({row:t})=>e.jsx("span",{className:"text-muted-foreground tabular-nums",children:t.getValue("sort")??"-"})},{accessorKey:"enabled",header:({column:t})=>e.jsx(x,{column:t,title:s("features.store.productSpecValue.scenario.columns.enabled")}),cell:({row:t})=>{const r=t.getValue("enabled");return e.jsx(xe,{variant:Se(r,"enabledStatus"),children:s(r===1?"features.store.productSpecValue.statusEnum.enable":"features.store.productSpecValue.statusEnum.disable")})}},{accessorKey:"createdAt",header:({column:t})=>e.jsx(x,{column:t,title:s("features.store.productSpecValue.scenario.columns.createdAt")}),cell:({row:t})=>e.jsx("div",{className:"text-muted-foreground whitespace-nowrap",children:t.getValue("createdAt")??"-"})},{id:"actions",header:s("features.store.productSpecValue.scenario.columns.actions"),cell:({row:t})=>{const r=t.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{children:[e.jsx(O,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>c(r.id),children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(Q,{children:s("features.store.productSpecValue.scenario.actions.edit")})]}),e.jsxs(H,{children:[e.jsx(O,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>m(r.id),children:e.jsx(ce,{className:"h-4 w-4 text-destructive"})})}),e.jsx(Q,{children:s("features.store.productSpecValue.scenario.actions.delete")})]})]})},enableHiding:!1,meta:{thClassName:"sticky right-0 bg-background z-10 shadow-[inset_-1px_0_0_0_hsl(var(--border))]",tdClassName:"sticky right-0 bg-background z-10 shadow-[inset_-1px_0_0_0_hsl(var(--border))]"}}],[s]),P=le({data:V,columns:D,getCoreRowModel:ie(),getSortedRowModel:ne(),getRowId:t=>t.id,onSortingChange:E,onColumnVisibilityChange:l,state:{sorting:w,columnVisibility:b}});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between px-4 pt-4",children:e.jsx(de,{title:s("features.store.productSpecValue.title"),description:s("features.store.productSpecValue.description"),children:e.jsxs(S,{onClick:()=>{c(null),f(!0)},children:[e.jsx(ue,{className:"h-4 w-4"}),s("features.store.productSpecValue.scenario.createButton")]})})}),e.jsx("div",{className:"rounded-md border p-6 mx-4",children:e.jsxs(me,{children:[e.jsx(pe,{children:P.getHeaderGroups().map(t=>e.jsx(g,{children:t.headers.map(r=>{const M=r.isPlaceholder?null:typeof r.column.columnDef.header=="function"?r.column.columnDef.header(r.getContext()):r.column.columnDef.header,R=r.column.columnDef.meta;return e.jsx(fe,{className:R?.thClassName,children:M},r.id)})},t.id))}),e.jsx(he,{children:o?e.jsx(g,{children:e.jsx(I,{colSpan:D.length,className:"h-24 text-center",children:s("features.store.productSpecValue.scenario.loading")})}):n?e.jsx(g,{children:e.jsx(I,{colSpan:D.length,className:"h-24 text-center text-destructive",children:s("features.store.productSpecValue.scenario.loadError")})}):P.getRowModel().rows?.length?P.getRowModel().rows.map(t=>e.jsx(g,{children:t.getVisibleCells().map(r=>{const M=typeof r.column.columnDef.cell=="function"?r.column.columnDef.cell(r.getContext()):r.column.columnDef.cell,R=r.column.columnDef.meta;return e.jsx(I,{className:R?.tdClassName,children:M},r.id)})},t.id)):e.jsx(g,{children:e.jsx(I,{colSpan:D.length,className:"h-24 text-center",children:s("features.store.productSpecValue.scenario.noData")})})})]})}),e.jsx(Re,{open:j||d!=null&&L!=null,onOpenChange:t=>{t||(f(!1),c(null))},onSubmit:t=>k.mutate(t),onSubmitUpdate:(t,r)=>q.mutate({productSpecItemID:t,data:r}),isLoading:k.isPending||q.isPending,editItem:L}),e.jsx(ge,{open:a!==null,onOpenChange:t=>{t||m(null)},title:s("features.store.productSpecValue.confirmDelete"),desc:s("features.store.productSpecValue.confirmDeleteDesc",{name:ee?.title??a??""}),handleConfirm:$,destructive:!0,confirmText:s("features.store.productSpecValue.scenario.actions.delete"),isLoading:B.isPending})]})}const nt=Ke;export{nt as component};
